---
description: Apply these rules when making changes to the project
globs:
alwaysApply: true
---

Update this rule if user requested changes to the project requirement, etc.
# App Flow Document

## Onboarding and Sign-In/Sign-Up
A new user arrives at the WIP Report Automation web application by navigating to the companyâ€™s secure intranet URL. On the landing page they see a welcome message and fields to enter their corporate email and password. If they have not yet received an invitation, they can request access by clicking the "Request Access" link, which opens a form to submit their name, department, and email. An administrator receives the request and, upon approval, sends an invitation email with a one-time link. When the user follows that link, they set a new password and complete a brief profile screen that captures their display name and time zone. Returning users simply enter their email and password on the sign-in page. If a password is forgotten, they click "Forgot Password," receive a reset link in their corporate inbox, and choose a new password. Once authenticated, the system directs them to the main dashboard. A "Sign Out" option appears in the top right corner on every page, ending their session and returning them to the landing page.

## Main Dashboard or Home Page
After signing in, the user lands on the main dashboard. The page prominently displays the current month and year selector at the top, defaulting to the present period. Below this selector are three file-upload panels labeled Master WIP Report, WIP Worksheet Export, and GL Inquiry Export. Each panel shows an icon indicating whether a file has been successfully uploaded and the name of the file. To the right of the upload area sits the primary action button labeled "Process Reports," which remains disabled until all required files are in place. A vertical sidebar on the left provides navigation to the Preview Updates, Audit Logs, and Settings pages. A user summary widget in the header greets the signed-in user by name and shows a status indicator of their last use date. Banner notifications appear above the uploads area to show any warnings or reminders, such as pending software updates or upcoming true-up periods.

## Detailed Feature Flows and Page Transitions
When the user selects a different month or year in the selector, the dashboard reloads to reflect that period and clears any previously uploaded files. Uploading each Excel file triggers an immediate validation step: the app checks for required columns and the correct file format. If a file passes validation, the panel shows a green checkmark; otherwise an inline error message appears explaining the issue. Once all three files are validated, the "Process Reports" button becomes active. Clicking this button transitions the user to a full-screen progress view where a stepper shows "Backing Up Master Report," "Aggregating GL Data," "Merging with WIP Worksheet," and "Preparing Preview." Each step displays a spinning icon and counts of completed jobs. If an unexpected issue arises, such as a missing header, the process pauses and shows a collapsible error panel with guidance. When processing finishes successfully, the app automatically creates a backup of the Master WIP Report in a WIP_Backups folder named with a timestamp and then navigates the user to the Preview Updates page.

On the Preview Updates page, the user sees two synchronized tables side by side. The left table shows current values from the existing monthly tab, and the right table shows the proposed values for sub-labor and material costs along with shaded cells highlighting preserved formulas. Variance flags appear as red or green markers next to any job where differences exceed the $1,000 threshold. Above the tables sits a short summary of total jobs processed, backups created, and variance count. At the bottom, two buttons read "Apply Updates" and "Return to Dashboard." Selecting "Apply Updates" triggers the write operation, clears only non-formula cells in the appropriate sections, and writes the new values while maintaining formatting and column widths. A confirmation banner appears when complete, showing the backup filename and noting that no formulas were overwritten. The user can then download the updated WIP Report and the separate validation report by clicking the newly enabled download buttons.

If at any time the user clicks the Preview Updates or Audit Logs links in the sidebar, the app transitions accordingly without losing the current session state or uploaded files. The Audit Logs page shows a paginated list of past runs with columns for date, user, input filenames, and status. Logs older than 12 months are hidden by default but can be retrieved through a date filter. Users may export log entries to CSV for external review.

## Settings and Account Management
The Settings page allows users to manage their personal profile and application preferences. At the top they see their display name and email with an "Edit Profile" button to update them. Below is a section labeled Processing Options where users can toggle whether to include closed jobs for quarterly true-ups, enable or disable automatic backups, and choose to preserve existing macros in the Master WIP Report. Each setting has a brief explanation next to it. Further down, the Backup Configuration section shows the backup folder location and retention policy, with a button to change the folder path. Any changes require clicking "Save Settings," which displays a success message when completed. A link at the bottom leads back to the Dashboard, ensuring users return seamlessly to the main flow.

## Error States and Alternate Paths
If users upload files lacking required columns or if the headers differ from expected patterns, the app displays a clear error message indicating which column is missing or unrecognized. Users can correct the file or manually map a header by clicking "Map Columns," which opens a modal allowing them to choose the correct column names. During processing, if connectivity is lost or the server fails, a full-screen error page appears with a retry button. Any attempt to process with incomplete uploads or unapproved settings shows a warning banner that prevents the action until the issue is resolved. If the write operation fails halfway, the system automatically restores the backup created before the run and notifies the user that the original file has been reinstated. Users can always access the Audit Logs to diagnose errors or view fallback entries in the CSV logs.

## Conclusion and Overall App Journey
From the moment a finance team member logs in, the WIP Report Automation app guides them smoothly through uploading source files, configuring processing options, and generating accurate monthly updates. They benefit from immediate feedback on upload success, a transparent preview that highlights preserved formulas and variance flags, and a reliable backup mechanism that ensures data integrity. Settings and logs remain easily accessible for audit and personalization, and any error triggers clear guidance for quick resolution. The end goal of reducing a three-hour manual process to under five minutes is achieved through a coherent journey that keeps users informed, in control, and confident in the accuracy of their WIP financial reports.